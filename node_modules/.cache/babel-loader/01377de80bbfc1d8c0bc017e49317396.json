{"remainingRequest":"/Users/andrewvanbeek/opa-dev-dash/node_modules/babel-loader/lib/index.js!/Users/andrewvanbeek/opa-dev-dash/node_modules/vuetify-loader/lib/loader.js??ref--18-0!/Users/andrewvanbeek/opa-dev-dash/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/andrewvanbeek/opa-dev-dash/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/andrewvanbeek/opa-dev-dash/src/views/Opa.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/andrewvanbeek/opa-dev-dash/src/views/Opa.vue","mtime":1592938331552},{"path":"/Users/andrewvanbeek/opa-dev-dash/node_modules/cache-loader/dist/cjs.js","mtime":1592873611678},{"path":"/Users/andrewvanbeek/opa-dev-dash/node_modules/babel-loader/lib/index.js","mtime":1592873611535},{"path":"/Users/andrewvanbeek/opa-dev-dash/node_modules/vuetify-loader/lib/loader.js","mtime":1592873617526},{"path":"/Users/andrewvanbeek/opa-dev-dash/node_modules/cache-loader/dist/cjs.js","mtime":1592873611678},{"path":"/Users/andrewvanbeek/opa-dev-dash/node_modules/vue-loader/lib/index.js","mtime":1592873617424}],"contextDependencies":[],"result":["import \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.regexp.split\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/andrewvanbeek/opa-dev-dash/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { Editor, EditorContent } from 'tiptap';\nexport default {\n  components: {\n    EditorContent: EditorContent\n  },\n  client_name: \"Developer\",\n  data: function data() {\n    return {\n      opaText: \"\",\n      method: \"GET\",\n      path: \"finance\",\n      access_token: \"\",\n      editor: null,\n      regoFragements: [],\n      client_creds_scopes: \"\",\n      user: \"\",\n      clients: [],\n      editedIndex: -1,\n      viewedItem: {\n        client_name: '',\n        client_id: 0,\n        client_secret: 0\n      },\n      defaultItem: {\n        client_name: '',\n        client_id: 0\n      }\n    };\n  },\n  computed: {\n    formTitle: function formTitle() {\n      return this.editedIndex === -1 ? 'New Oauth App' : 'View Oauth Client';\n    }\n  },\n  watch: {\n    dialog: function dialog(val) {\n      val || this.close();\n    }\n  },\n  created: function created() {\n    this.initialize();\n    console.log(process.env.VUE_APP_OKTA_ISSUER);\n    this.okta_issuer = process.env.VUE_APP_OKTA_ISSUER;\n  },\n  methods: {\n    initialize: function () {\n      var _initialize = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var component, user, accessToken, accessTokenobj, baseURI, opa, rego, niceRego;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                component = this;\n                _context.next = 3;\n                return this.$auth.getUser();\n\n              case 3:\n                user = _context.sent;\n                _context.next = 6;\n                return this.$auth.getAccessToken();\n\n              case 6:\n                accessToken = _context.sent;\n                accessTokenobj = {\n                  accessToken: accessToken\n                };\n                this.user = user.preferred_username;\n                baseURI = \"http://localhost:8000/opa\";\n                _context.next = 12;\n                return this.$http.get(baseURI);\n\n              case 12:\n                opa = _context.sent;\n                this.regoFragements = opa.data.rego.split(\"\\n\");\n                rego = opa.data.rego.split('\\n').join('</br>');\n                niceRego = this.createPrettyString(this.regoFragements);\n                this.editor = new Editor({\n                  content: niceRego\n                });\n\n              case 17:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function initialize() {\n        return _initialize.apply(this, arguments);\n      }\n\n      return initialize;\n    }(),\n    saveRego: function () {\n      var _saveRego = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        var baseURI, jsonContent, htmlContent, regoToSend, opa;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                baseURI = \"http://localhost:8000/rego\";\n                jsonContent = this.editor.getJSON();\n                htmlContent = this.editor.getHTML();\n                console.log(jsonContent.content);\n                regoToSend = this.createFormattedString(jsonContent.content);\n                console.log(regoToSend);\n                _context2.next = 8;\n                return this.$http.post(baseURI, {\n                  rego: regoToSend\n                });\n\n              case 8:\n                opa = _context2.sent;\n\n              case 9:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function saveRego() {\n        return _saveRego.apply(this, arguments);\n      }\n\n      return saveRego;\n    }(),\n    sendToOpa: function () {\n      var _sendToOpa = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {\n        var component, baseURI, opa;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                component = this;\n                baseURI = \"http://localhost:8000/opaAuthz\";\n                _context3.next = 4;\n                return this.$http.post(baseURI, {\n                  \"method\": component.method,\n                  \"path\": component.path,\n                  \"token\": component.access_token\n                });\n\n              case 4:\n                opa = _context3.sent;\n                console.log(opa);\n\n              case 6:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function sendToOpa() {\n        return _sendToOpa.apply(this, arguments);\n      }\n\n      return sendToOpa;\n    }(),\n    resetRego: function () {\n      var _resetRego = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {\n        var baseURI, opa;\n        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                baseURI = \"http://localhost:8000/rego\";\n                _context4.next = 3;\n                return this.$http.delete(baseURI);\n\n              case 3:\n                opa = _context4.sent;\n                this.$router.go();\n\n              case 5:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function resetRego() {\n        return _resetRego.apply(this, arguments);\n      }\n\n      return resetRego;\n    }(),\n    createPrettyString: function createPrettyString(fragments) {\n      var string = \"\";\n      fragments.forEach(function (item, i) {\n        string += \"<p>\" + item + \"</p><br>\";\n      });\n      return string;\n    },\n    createFormattedString: function createFormattedString(contentObjects) {\n      var string = \"\";\n      contentObjects.forEach(function (item, i) {\n        if (item.content) {\n          string += item.content[0].text + \"\\n\";\n\n          if (item.content[0].text.includes(\"}\")) {\n            string += \"\\n\";\n          }\n        }\n      });\n      return string;\n    },\n    logout: function () {\n      var _logout = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5() {\n        return regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.next = 2;\n                return this.$auth.logout();\n\n              case 2:\n                _context5.next = 4;\n                return this.$auth.isAuthenticated();\n\n              case 4:\n                // Navigate back to home\n                window.location.reload();\n\n              case 5:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function logout() {\n        return _logout.apply(this, arguments);\n      }\n\n      return logout;\n    }()\n  }\n};",{"version":3,"sources":["Opa.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n\n  <v-row justify=\"center\">\n    <v-col cols=\"6\">\n      <v-card width=\"1000px\" scrollable=\"true\">\n        <v-card-title>Test Authorization</v-card-title>\n        <v-divider></v-divider>\n        <v-card-actions>\n          <v-btn color=\"blue darken-1\" text @click=\"sendToOpa()\">Send</v-btn>\n        </v-card-actions>\n        <v-divider></v-divider>\n        <v-form v-model=\"valid\">\n          <v-container>\n            <v-row>\n              <v-col\n              cols=\"12\"\n              md=\"4\"\n              >\n              <v-text-field\n              v-model=\"method\"\n              ></v-text-field>\n            </v-col>\n\n            <v-col\n            cols=\"12\"\n            md=\"4\"\n            >\n            <v-text-field\n            v-model=\"path\"\n            ></v-text-field>\n          </v-col>\n        </v-row>\n        <v-row>\n          <v-col cols=\"12\" md=\"6\">\n            <v-textarea\n            outlined\n            name=\"input-7-4\"\n            label=\"Outlined textarea\"\n            v-model=\"access_token\"\n            ></v-textarea>\n          </v-col>\n        </v-row>\n      </v-container>\n    </v-form>\n    <div class=\"d-block pa-2 black white--text scroll\">\n      What we are going to send to Open Policy Agent\n      {\n        \"input\":{\n          \"method\": \"{{method}}\",\n          \"path\": \"{{path}}\",\n          \"token\": \"{{access_token}}\"\n        }\n      }\n    </div>\n    <v-divider></v-divider>\n  </v-card>\n</v-col>\n<v-col cols=\"6\">\n  <v-card max-height=\"200px\" width=\"1000px\" scrollable=\"true\">\n    <v-card-title>Edit Opa Policy</v-card-title>\n    <v-divider></v-divider>\n    <div class=\"d-block pa-2 black white--text scroll\">\n      <!-- <h3>Run command below</h3>\n      <p v-for=\"fragment in regoFragements\">{{fragment}}<br></p> -->\n      <editor-content :editor=\"editor\" />\n    </div>\n    <v-divider></v-divider>\n    <v-card-actions>\n      <v-btn color=\"blue darken-1\" text @click=\"saveRego()\">Save</v-btn>\n      <v-btn color=\"blue darken-1\" text @click=\"resetRego()\">Reset</v-btn>\n    </v-card-actions>\n  </v-card>\n</v-col>\n</v-row>\n</template>\n\n<script>\nimport { Editor, EditorContent } from 'tiptap'\nexport default {\n  components: {\n    EditorContent,\n  },\n  client_name: \"Developer\",\n  data: () => ({\n\n    opaText: \"\",\n    method: \"GET\",\n    path: \"finance\",\n    access_token: \"\",\n    editor: null,\n    regoFragements: [],\n    client_creds_scopes: \"\",\n    user: \"\",\n    clients: [],\n    editedIndex: -1,\n    viewedItem: {\n      client_name: '',\n      client_id: 0,\n      client_secret: 0,\n    },\n    defaultItem: {\n      client_name: '',\n      client_id: 0,\n    },\n  }),\n\n  computed: {\n    formTitle() {\n      return this.editedIndex === -1 ? 'New Oauth App' : 'View Oauth Client'\n    },\n  },\n\n  watch: {\n    dialog(val) {\n      val || this.close()\n    },\n  },\n\n  created() {\n    this.initialize()\n    console.log(process.env.VUE_APP_OKTA_ISSUER)\n    this.okta_issuer = process.env.VUE_APP_OKTA_ISSUER\n  },\n\n  methods: {\n    async initialize() {\n      var component = this\n      var user = await this.$auth.getUser()\n      var accessToken = await this.$auth.getAccessToken();\n      const accessTokenobj = {\n        accessToken\n      }\n      this.user = user.preferred_username\n      const baseURI = \"http://localhost:8000/opa\"\n      var opa = await this.$http.get(baseURI)\n      this.regoFragements = opa.data.rego.split(\"\\n\")\n      var rego = opa.data.rego.split('\\n').join('</br>');\n      var niceRego = this.createPrettyString(this.regoFragements)\n      this.editor = new Editor({\n        content: niceRego,\n      })\n    },\n    async saveRego() {\n      const baseURI = \"http://localhost:8000/rego\"\n      var jsonContent = this.editor.getJSON()\n      var htmlContent = this.editor.getHTML()\n      console.log(jsonContent.content)\n      var regoToSend = this.createFormattedString(jsonContent.content)\n      console.log(regoToSend)\n      var opa = await this.$http.post(baseURI, {rego: regoToSend})\n    },\n    async sendToOpa() {\n      var component = this\n      const baseURI = \"http://localhost:8000/opaAuthz\"\n      var opa = await this.$http.post(baseURI, {\n          \"method\": component.method,\n          \"path\": component.path,\n          \"token\": component.access_token\n      })\n      console.log(opa)\n    },\n    async resetRego() {\n      const baseURI = \"http://localhost:8000/rego\"\n      var opa = await this.$http.delete(baseURI)\n      this.$router.go()\n    },\n    createPrettyString(fragments) {\n      var string = \"\"\n      fragments.forEach((item, i) => {\n        string += \"<p>\" + item + \"</p><br>\"\n      });\n      return string\n    },\n    createFormattedString(contentObjects) {\n      var string = \"\"\n      contentObjects.forEach((item, i) => {\n        if(item.content) {\n          string += item.content[0].text + \"\\n\"\n          if(item.content[0].text.includes(\"}\")){\n            string += \"\\n\"\n          }\n        }\n      });\n      return string\n    },\n    async logout() {\n      await this.$auth.logout()\n      await this.$auth.isAuthenticated()\n\n      // Navigate back to home\n      window.location.reload()\n    }\n  },\n}\n</script>\n\n<style>\n.scroll {\n  overflow-y: auto;\n  height: 600px;\n}\n</style>\n"],"sourceRoot":"src/views"}]}