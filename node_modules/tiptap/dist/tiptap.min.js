
    /*!
    * tiptap v1.27.0
    * (c) 2020 Scrumpy UG (limited liability)
    * @license MIT
    */


/*!
    * tiptap v1.27.0
    * (c) 2020 Scrumpy UG (limited liability)
    * @license MIT
    */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("prosemirror-state"),require("prosemirror-view"),require("prosemirror-model"),require("prosemirror-dropcursor"),require("prosemirror-gapcursor"),require("prosemirror-keymap"),require("prosemirror-commands"),require("prosemirror-inputrules"),require("tiptap-utils"),require("vue"),require("tiptap-commands")):"function"==typeof define&&define.amd?define(["exports","prosemirror-state","prosemirror-view","prosemirror-model","prosemirror-dropcursor","prosemirror-gapcursor","prosemirror-keymap","prosemirror-commands","prosemirror-inputrules","tiptap-utils","vue","tiptap-commands"],t):t((e=e||self).tiptap={},e.prosemirrorState,e.prosemirrorView,e.prosemirrorModel,e.prosemirrorDropcursor,e.prosemirrorGapcursor,e.prosemirrorKeymap,e.prosemirrorCommands,e.prosemirrorInputrules,e.tiptapUtils,e.Vue,e.tiptapCommands)}(this,(function(e,t,n,i,r,o,s,u,a,c,l,d){"use strict";function h(e){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function v(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function P(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function x(e){return function(){var t,n=k(e);if(O()){var i=k(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return P(this,t)}}function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var s,u=e[Symbol.iterator]();!(i=(s=u.next()).done)&&(n.push(s.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{i||null==u.return||u.return()}finally{if(r)throw o}}return n}(e,t)||S(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e){return function(e){if(Array.isArray(e))return E(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||S(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){if(e){if("string"==typeof e)return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E(e,t):void 0}}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function N(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,(function(e,t){return 0===t?e.toLowerCase():e.toUpperCase()})).replace(/\s+/g,"")}l=l&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l;var j=function(){function e(t,n){var i=n.editor,r=n.extension,o=n.parent,s=n.node,u=n.view,a=n.decorations,c=n.getPos;f(this,e),this.component=t,this.editor=i,this.extension=r,this.parent=o,this.node=s,this.view=u,this.decorations=a,this.isNode=!!this.node.marks,this.isMark=!this.isNode,this.getPos=this.isMark?this.getMarkPos:c,this.captureEvents=!0,this.dom=this.createDOM(),this.contentDOM=this.vm.$refs.content}return v(e,[{key:"createDOM",value:function(){var e=this,t=l.extend(this.component),n={editor:this.editor,node:this.node,view:this.view,getPos:function(){return e.getPos()},decorations:this.decorations,selected:!1,options:this.extension.options,updateAttrs:function(t){return e.updateAttrs(t)}};return"function"==typeof this.extension.setSelection&&(this.setSelection=this.extension.setSelection),"function"==typeof this.extension.update&&(this.update=this.extension.update),this.vm=new t({parent:this.parent,propsData:n}).$mount(),this.vm.$el}},{key:"update",value:function(e,t){return e.type===this.node.type&&(e===this.node&&this.decorations===t||(this.node=e,this.decorations=t,this.updateComponentProps({node:e,decorations:t})),!0)}},{key:"updateComponentProps",value:function(e){var t=this;if(this.vm._props){var n=l.config.silent;l.config.silent=!0,Object.entries(e).forEach((function(e){var n=A(e,2),i=n[0],r=n[1];t.vm._props[i]=r})),l.config.silent=n}}},{key:"updateAttrs",value:function(e){if(this.view.editable){var t=this.view.state,n=this.node.type,i=this.getPos(),r=g({},this.node.attrs,{},e),o=this.isMark?t.tr.removeMark(i.from,i.to,n).addMark(i.from,i.to,n.create(r)):t.tr.setNodeMarkup(i,null,r);this.view.dispatch(o)}}},{key:"ignoreMutation",value:function(e){return"selection"!==e.type&&(!this.contentDOM||!this.contentDOM.contains(e.target))}},{key:"stopEvent",value:function(e){var t=this;if("function"==typeof this.extension.stopEvent)return this.extension.stopEvent(e);var n=!!this.extension.schema.draggable;if(n&&"mousedown"===e.type){var i=e.target.closest&&e.target.closest("[data-drag-handle]");i&&(this.dom===i||this.dom.contains(i))&&(this.captureEvents=!1,document.addEventListener("dragend",(function(){t.captureEvents=!0}),{once:!0}))}var r="copy"===e.type,o="paste"===e.type,s="cut"===e.type,u=e.type.startsWith("drag")||"drop"===e.type;return!(n&&u||r||o||s)&&this.captureEvents}},{key:"selectNode",value:function(){this.updateComponentProps({selected:!0})}},{key:"deselectNode",value:function(){this.updateComponentProps({selected:!1})}},{key:"getMarkPos",value:function(){var e=this.view.posAtDOM(this.dom),t=this.view.state.doc.resolve(e);return c.getMarkRange(t,this.node.type)}},{key:"destroy",value:function(){this.vm.$destroy()}}]),e}(),C=function(){function e(){f(this,e)}return v(e,[{key:"on",value:function(e,t){return this._callbacks=this._callbacks||{},this._callbacks[e]||(this._callbacks[e]=[]),this._callbacks[e].push(t),this}},{key:"emit",value:function(e){for(var t=this,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this._callbacks=this._callbacks||{};var o=this._callbacks[e];return o&&o.forEach((function(e){return e.apply(t,i)})),this}},{key:"off",value:function(e,t){if(arguments.length){var n=this._callbacks?this._callbacks[e]:null;n&&(t?this._callbacks[e]=n.filter((function(e){return e!==t})):delete this._callbacks[e])}else this._callbacks={};return this}}]),e}(),H=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};f(this,e),this.options=g({},this.defaultOptions,{},t)}return v(e,[{key:"init",value:function(){return null}},{key:"bindEditor",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.editor=e}},{key:"inputRules",value:function(){return[]}},{key:"pasteRules",value:function(){return[]}},{key:"keys",value:function(){return{}}},{key:"name",get:function(){return null}},{key:"type",get:function(){return"extension"}},{key:"defaultOptions",get:function(){return{}}},{key:"plugins",get:function(){return[]}}]),e}(),R=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;f(this,e),t.forEach((function(e){e.bindEditor(n),e.init()})),this.extensions=t}return v(e,[{key:"keymaps",value:function(e){var t=e.schema,n=this.extensions.filter((function(e){return["extension"].includes(e.type)})).filter((function(e){return e.keys})).map((function(e){return e.keys({schema:t})})),i=this.extensions.filter((function(e){return["node","mark"].includes(e.type)})).filter((function(e){return e.keys})).map((function(e){return e.keys({type:t["".concat(e.type,"s")][e.name],schema:t})}));return[].concat(M(n),M(i)).map((function(e){return s.keymap(e)}))}},{key:"inputRules",value:function(e){var t=e.schema,n=e.excludedExtensions;if(!(n instanceof Array)&&n)return[];var i=n instanceof Array?this.extensions.filter((function(e){return!n.includes(e.name)})):this.extensions,r=i.filter((function(e){return["extension"].includes(e.type)})).filter((function(e){return e.inputRules})).map((function(e){return e.inputRules({schema:t})})),o=i.filter((function(e){return["node","mark"].includes(e.type)})).filter((function(e){return e.inputRules})).map((function(e){return e.inputRules({type:t["".concat(e.type,"s")][e.name],schema:t})}));return[].concat(M(r),M(o)).reduce((function(e,t){return[].concat(M(e),M(t))}),[])}},{key:"pasteRules",value:function(e){var t=e.schema,n=e.excludedExtensions;if(!(n instanceof Array)&&n)return[];var i=n instanceof Array?this.extensions.filter((function(e){return!n.includes(e.name)})):this.extensions,r=i.filter((function(e){return["extension"].includes(e.type)})).filter((function(e){return e.pasteRules})).map((function(e){return e.pasteRules({schema:t})})),o=i.filter((function(e){return["node","mark"].includes(e.type)})).filter((function(e){return e.pasteRules})).map((function(e){return e.pasteRules({type:t["".concat(e.type,"s")][e.name],schema:t})}));return[].concat(M(r),M(o)).reduce((function(e,t){return[].concat(M(e),M(t))}),[])}},{key:"commands",value:function(e){var t=e.schema,n=e.view;return this.extensions.filter((function(e){return e.commands})).reduce((function(e,i){var r=i.name,o=i.type,s={},u=i.commands(g({schema:t},["node","mark"].includes(o)?{type:t["".concat(o,"s")][r]}:{})),a=function(e,t){return!!n.editable&&(n.focus(),e(t)(n.state,n.dispatch,n))},c=function(e,t){Array.isArray(t)?s[e]=function(e){return t.forEach((function(t){return a(t,e)}))}:"function"==typeof t&&(s[e]=function(e){return a(t,e)})};return"object"===h(u)?Object.entries(u).forEach((function(e){var t=A(e,2),n=t[0],i=t[1];c(n,i)})):c(r,u),g({},e,{},s)}),{})}},{key:"nodes",get:function(){return this.extensions.filter((function(e){return"node"===e.type})).reduce((function(e,t){return g({},e,m({},t.name,t.schema))}),{})}},{key:"options",get:function(){var e=this.view;return this.extensions.reduce((function(t,n){return g({},t,m({},n.name,new Proxy(n.options,{set:function(t,n,i){var r=t[n]!==i;return Object.assign(t,m({},n,i)),r&&e.updateState(e.state),!0}})))}),{})}},{key:"marks",get:function(){return this.extensions.filter((function(e){return"mark"===e.type})).reduce((function(e,t){return g({},e,m({},t.name,t.schema))}),{})}},{key:"plugins",get:function(){return this.extensions.filter((function(e){return e.plugins})).reduce((function(e,t){var n=t.plugins;return[].concat(M(e),M(n))}),[])}}]),e}();function T(e){var t=document.createElement("style");t.type="text/css",t.textContent=e;var n=document.head,i=n.firstChild;i?n.insertBefore(t,i):n.appendChild(t)}var D=function(e){b(n,e);var t=x(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return f(this,n),t.call(this,e)}return v(n,[{key:"command",value:function(){return function(){}}},{key:"type",get:function(){return"mark"}},{key:"view",get:function(){return null}},{key:"schema",get:function(){return null}}]),n}(H);function _(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.min(Math.max(parseInt(e,10),t),n)}var I=function(e){b(n,e);var t=x(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return f(this,n),t.call(this,e)}return v(n,[{key:"command",value:function(){return function(){}}},{key:"type",get:function(){return"node"}},{key:"view",get:function(){return null}},{key:"schema",get:function(){return null}}]),n}(H),V=function(e){b(n,e);var t=x(n);function n(){return f(this,n),t.apply(this,arguments)}return v(n,[{key:"name",get:function(){return"doc"}},{key:"schema",get:function(){return{content:"block+"}}}]),n}(I),U=function(e){b(n,e);var t=x(n);function n(){return f(this,n),t.apply(this,arguments)}return v(n,[{key:"commands",value:function(e){var t=e.type;return function(){return d.setBlockType(t)}}},{key:"name",get:function(){return"paragraph"}},{key:"schema",get:function(){return{content:"inline*",group:"block",draggable:!1,parseDOM:[{tag:"p"}],toDOM:function(){return["p",0]}}}}]),n}(I),$=function(e){b(n,e);var t=x(n);function n(){return f(this,n),t.apply(this,arguments)}return v(n,[{key:"name",get:function(){return"text"}},{key:"schema",get:function(){return{group:"inline"}}}]),n}(I),B='.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n',z=function(e){b(d,e);var l=x(d);function d(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return f(this,d),(e=l.call(this)).defaultOptions={editorProps:{},editable:!0,autoFocus:null,extensions:[],content:"",topNode:"doc",emptyDocument:{type:"doc",content:[{type:"paragraph"}]},useBuiltInExtensions:!0,disableInputRules:!1,disablePasteRules:!1,dropCursor:{},parseOptions:{},injectCSS:!0,onInit:function(){},onTransaction:function(){},onUpdate:function(){},onFocus:function(){},onBlur:function(){},onPaste:function(){},onDrop:function(){}},e.events=["init","transaction","update","focus","blur","paste","drop"],e.init(t),e}return v(d,[{key:"init",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.setOptions(g({},this.defaultOptions,{},t)),this.focused=!1,this.selection={from:0,to:0},this.element=document.createElement("div"),this.extensions=this.createExtensions(),this.nodes=this.createNodes(),this.marks=this.createMarks(),this.schema=this.createSchema(),this.plugins=this.createPlugins(),this.keymaps=this.createKeymaps(),this.inputRules=this.createInputRules(),this.pasteRules=this.createPasteRules(),this.view=this.createView(),this.commands=this.createCommands(),this.setActiveNodesAndMarks(),this.options.injectCSS&&T(B),null!==this.options.autoFocus&&this.focus(this.options.autoFocus),this.events.forEach((function(t){e.on(t,e.options[N("on ".concat(t))]||function(){})})),this.emit("init",{view:this.view,state:this.state}),this.extensions.view=this.view}},{key:"setOptions",value:function(e){this.options=g({},this.options,{},e),this.view&&this.state&&this.view.updateState(this.state)}},{key:"createExtensions",value:function(){return new R([].concat(M(this.builtInExtensions),M(this.options.extensions)),this)}},{key:"createPlugins",value:function(){return this.extensions.plugins}},{key:"createKeymaps",value:function(){return this.extensions.keymaps({schema:this.schema})}},{key:"createInputRules",value:function(){return this.extensions.inputRules({schema:this.schema,excludedExtensions:this.options.disableInputRules})}},{key:"createPasteRules",value:function(){return this.extensions.pasteRules({schema:this.schema,excludedExtensions:this.options.disablePasteRules})}},{key:"createCommands",value:function(){return this.extensions.commands({schema:this.schema,view:this.view})}},{key:"createNodes",value:function(){return this.extensions.nodes}},{key:"createMarks",value:function(){return this.extensions.marks}},{key:"createSchema",value:function(){return new i.Schema({topNode:this.options.topNode,nodes:this.nodes,marks:this.marks})}},{key:"createState",value:function(){var e=this;return t.EditorState.create({schema:this.schema,doc:this.createDocument(this.options.content),plugins:[].concat(M(this.plugins),[a.inputRules({rules:this.inputRules})],M(this.pasteRules),M(this.keymaps),[s.keymap({Backspace:a.undoInputRule}),s.keymap(u.baseKeymap),r.dropCursor(this.options.dropCursor),o.gapCursor(),new t.Plugin({key:new t.PluginKey("editable"),props:{editable:function(){return e.options.editable}}}),new t.Plugin({props:{attributes:{tabindex:0},handleDOMEvents:{focus:function(t,n){e.focused=!0,e.emit("focus",{event:n,state:t.state,view:t});var i=e.state.tr.setMeta("focused",!0);e.view.dispatch(i)},blur:function(t,n){e.focused=!1,e.emit("blur",{event:n,state:t.state,view:t});var i=e.state.tr.setMeta("focused",!1);e.view.dispatch(i)}}}}),new t.Plugin({props:this.options.editorProps})])})}},{key:"createDocument",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options.parseOptions;if(null===e)return this.schema.nodeFromJSON(this.options.emptyDocument);if("object"===h(e))try{return this.schema.nodeFromJSON(e)}catch(t){return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",t),this.schema.nodeFromJSON(this.options.emptyDocument)}if("string"==typeof e){var n=document.createElement("div");return n.innerHTML=e.trim(),i.DOMParser.fromSchema(this.schema).parse(n,t)}return!1}},{key:"createView",value:function(){var e=this;return new n.EditorView(this.element,{state:this.createState(),handlePaste:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];e.emit.apply(e,["paste"].concat(n))},handleDrop:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];e.emit.apply(e,["drop"].concat(n))},dispatchTransaction:this.dispatchTransaction.bind(this)})}},{key:"setParentComponent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&this.view.setProps({nodeViews:this.initNodeViews({parent:e,extensions:[].concat(M(this.builtInExtensions),M(this.options.extensions))})})}},{key:"initNodeViews",value:function(e){var t=this,n=e.parent;return e.extensions.filter((function(e){return["node","mark"].includes(e.type)})).filter((function(e){return e.view})).reduce((function(e,i){return g({},e,m({},i.name,(function(e,r,o,s){var u=i.view;return new j(u,{editor:t,extension:i,parent:n,node:e,view:r,getPos:o,decorations:s})})))}),{})}},{key:"dispatchTransaction",value:function(e){var t=this.state.apply(e);this.view.updateState(t),this.selection={from:this.state.selection.from,to:this.state.selection.to},this.setActiveNodesAndMarks(),this.emit("transaction",{getHTML:this.getHTML.bind(this),getJSON:this.getJSON.bind(this),state:this.state,transaction:e}),e.docChanged&&!e.getMeta("preventUpdate")&&this.emitUpdate(e)}},{key:"emitUpdate",value:function(e){this.emit("update",{getHTML:this.getHTML.bind(this),getJSON:this.getJSON.bind(this),state:this.state,transaction:e})}},{key:"resolveSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(this.selection&&null===e)return this.selection;if("start"===e||!0===e)return{from:0,to:0};if("end"===e){var t=this.state.doc;return{from:t.content.size,to:t.content.size}}return{from:e,to:e}}},{key:"focus",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!(this.view.focused&&null===t||!1===t)){var n=this.resolveSelection(t),i=n.from,r=n.to;this.setSelection(i,r),setTimeout((function(){return e.view.focus()}),10)}}},{key:"setSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.state,r=i.doc,o=i.tr,s=_(e,0,r.content.size),u=_(n,0,r.content.size),a=t.TextSelection.create(r,s,u),c=o.setSelection(a);this.view.dispatch(c)}},{key:"blur",value:function(){this.view.dom.blur()}},{key:"getSchemaJSON",value:function(){return JSON.parse(JSON.stringify({nodes:this.extensions.nodes,marks:this.extensions.marks}))}},{key:"getHTML",value:function(){var e=document.createElement("div"),t=i.DOMSerializer.fromSchema(this.schema).serializeFragment(this.state.doc.content);return e.appendChild(t),e.innerHTML}},{key:"getJSON",value:function(){return this.state.doc.toJSON()}},{key:"setContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2?arguments[2]:void 0,r=this.state,o=r.doc,s=r.tr,u=this.createDocument(e,i),a=t.TextSelection.create(o,0,o.content.size),c=s.setSelection(a).replaceSelectionWith(u,!1).setMeta("preventUpdate",!n);this.view.dispatch(c)}},{key:"clearContent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.setContent(this.options.emptyDocument,e)}},{key:"setActiveNodesAndMarks",value:function(){var e=this;this.activeMarks=Object.entries(this.schema.marks).reduce((function(t,n){var i=A(n,2),r=i[0],o=i[1];return g({},t,m({},r,(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c.markIsActive(e.state,o,t)})))}),{}),this.activeMarkAttrs=Object.entries(this.schema.marks).reduce((function(t,n){var i=A(n,2),r=i[0],o=i[1];return g({},t,m({},r,c.getMarkAttrs(e.state,o)))}),{}),this.activeNodes=Object.entries(this.schema.nodes).reduce((function(t,n){var i=A(n,2),r=i[0],o=i[1];return g({},t,m({},r,(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c.nodeIsActive(e.state,o,t)})))}),{})}},{key:"getMarkAttrs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.activeMarkAttrs[e]}},{key:"getNodeAttrs",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return g({},c.getNodeAttrs(this.state,this.schema.nodes[e]))}},{key:"registerPlugin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n="function"==typeof t?t(e,this.state.plugins):[e].concat(M(this.state.plugins)),i=this.state.reconfigure({plugins:n});this.view.updateState(i)}},{key:"unregisterPlugin",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(e&&this.view.docView){var t=this.state.reconfigure({plugins:this.state.plugins.filter((function(t){return!t.key.startsWith("".concat(e,"$"))}))});this.view.updateState(t)}}},{key:"destroy",value:function(){this.view&&this.view.destroy()}},{key:"builtInExtensions",get:function(){return this.options.useBuiltInExtensions?[new V,new $,new U]:[]}},{key:"state",get:function(){return this.view?this.view.state:null}},{key:"isActive",get:function(){return Object.entries(g({},this.activeMarks,{},this.activeNodes)).reduce((function(e,t){var n=A(t,2),i=n[0],r=n[1];return g({},e,m({},i,(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r(e)})))}),{})}}]),d}(C),L={props:{editor:{default:null,type:Object}},watch:{editor:{immediate:!0,handler:function(e){var t=this;e&&e.element&&this.$nextTick((function(){t.$el.appendChild(e.element.firstChild),e.setParentComponent(t)}))}}},render:function(e){return e("div")},beforeDestroy:function(){this.editor.element=this.$el}},q=function(){function e(t){var n=this,i=t.options;f(this,e),this.options=i,this.preventHide=!1,this.mousedownHandler=this.handleClick.bind(this),this.options.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.blurHandler=function(){n.preventHide?n.preventHide=!1:n.options.editor.emit("menubar:focusUpdate",!1)},this.options.editor.on("blur",this.blurHandler)}return v(e,[{key:"handleClick",value:function(){this.preventHide=!0}},{key:"destroy",value:function(){this.options.element.removeEventListener("mousedown",this.mousedownHandler),this.options.editor.off("blur",this.blurHandler)}}]),e}();var J={props:{editor:{default:null,type:Object}},data:function(){return{focused:!1}},watch:{editor:{immediate:!0,handler:function(e){var n=this;e&&this.$nextTick((function(){var i;e.registerPlugin((i={editor:e,element:n.$el},new t.Plugin({key:new t.PluginKey("menu_bar"),view:function(e){return new q({editorView:e,options:i})}}))),n.focused=e.focused,e.on("focus",(function(){n.focused=!0})),e.on("menubar:focusUpdate",(function(e){n.focused=e}))}))}}},render:function(){return this.editor?this.$scopedSlots.default({focused:this.focused,focus:this.editor.focus,commands:this.editor.commands,isActive:this.editor.isActive,getMarkAttrs:this.editor.getMarkAttrs.bind(this.editor),getNodeAttrs:this.editor.getNodeAttrs.bind(this.editor)}):null}};function F(e,t,n){var i=document.createRange();return i.setEnd(e,null==n?e.nodeValue.length:n),i.setStart(e,t||0),i}function K(e,t){var n=e.getClientRects();return n.length?n[t<0?0:n.length-1]:e.getBoundingClientRect()}function W(e,t){var n,i,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=e.docView.domFromPos(t),s=o.node,u=o.offset;if(3===s.nodeType)r&&u<s.nodeValue.length?(i=K(F(s,u-1,u),-1),n="right"):u<s.nodeValue.length&&(i=K(F(s,u,u+1),-1),n="left");else if(s.firstChild){if(u<s.childNodes.length){var a=s.childNodes[u];i=K(3===a.nodeType?F(a):a,-1),n="left"}if((!i||i.top===i.bottom)&&u){var c=s.childNodes[u-1];i=K(3===c.nodeType?F(c):c,1),n="right"}}else i=s.getBoundingClientRect(),n="left";var l=i[n];return{top:i.top,bottom:i.bottom,left:l,right:l}}var G=function(){function e(t){var n=this,i=t.options,r=t.editorView;f(this,e),this.options=g({},{element:null,keepInBounds:!0,onUpdate:function(){return!1}},{},i),this.editorView=r,this.isActive=!1,this.left=0,this.bottom=0,this.top=0,this.preventHide=!1,this.mousedownHandler=this.handleClick.bind(this),this.options.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.focusHandler=function(e){var t=e.view;n.update(t)},this.options.editor.on("focus",this.focusHandler),this.blurHandler=function(e){var t=e.event;n.preventHide?n.preventHide=!1:n.hide(t)},this.options.editor.on("blur",this.blurHandler)}return v(e,[{key:"handleClick",value:function(){this.preventHide=!0}},{key:"update",value:function(e,t){var n=e.state;if(!(e.composing||t&&t.doc.eq(n.doc)&&t.selection.eq(n.selection)))if(n.selection.empty)this.hide();else{var i=n.selection,r=i.from,o=i.to,s=W(e,r),u=W(e,o,!0),a=this.options.element.offsetParent;if(a){var c=a.getBoundingClientRect(),l=this.options.element.getBoundingClientRect(),d=(s.left+u.left)/2-c.left;this.left=Math.round(this.options.keepInBounds?Math.min(c.width-l.width/2,Math.max(d,l.width/2)):d),this.bottom=Math.round(c.bottom-s.top),this.top=Math.round(u.bottom-c.top),this.isActive=!0,this.sendUpdate()}else this.hide()}}},{key:"sendUpdate",value:function(){this.options.onUpdate({isActive:this.isActive,left:this.left,bottom:this.bottom,top:this.top})}},{key:"hide",value:function(e){e&&e.relatedTarget&&this.options.element.parentNode&&this.options.element.parentNode.contains(e.relatedTarget)||(this.isActive=!1,this.sendUpdate())}},{key:"destroy",value:function(){this.options.element.removeEventListener("mousedown",this.mousedownHandler),this.options.editor.off("focus",this.focusHandler),this.options.editor.off("blur",this.blurHandler)}}]),e}();var Z={props:{editor:{default:null,type:Object},keepInBounds:{default:!0,type:Boolean}},data:function(){return{menu:{isActive:!1,left:0,bottom:0}}},watch:{editor:{immediate:!0,handler:function(e){var n=this;e&&this.$nextTick((function(){var i;e.registerPlugin((i={editor:e,element:n.$el,keepInBounds:n.keepInBounds,onUpdate:function(e){e.isActive&&!1===n.menu.isActive?n.$emit("show",e):e.isActive||!0!==n.menu.isActive||n.$emit("hide",e),n.menu=e}},new t.Plugin({key:new t.PluginKey("menu_bubble"),view:function(e){return new G({editorView:e,options:i})}})))}))}}},render:function(){return this.editor?this.$scopedSlots.default({focused:this.editor.view.focused,focus:this.editor.focus,commands:this.editor.commands,isActive:this.editor.isActive,getMarkAttrs:this.editor.getMarkAttrs.bind(this.editor),getNodeAttrs:this.editor.getNodeAttrs.bind(this.editor),menu:this.menu}):null},beforeDestroy:function(){this.editor.unregisterPlugin("menu_bubble")}},Q=function(){function e(t){var n=this,i=t.options,r=t.editorView;f(this,e),this.options=g({},{resizeObserver:!0,element:null,onUpdate:function(){return!1}},{},i),this.preventHide=!1,this.editorView=r,this.isActive=!1,this.top=0,this.mousedownHandler=this.handleClick.bind(this),this.options.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.focusHandler=function(e){var t=e.view;n.update(t)},this.options.editor.on("focus",this.focusHandler),this.blurHandler=function(e){var t=e.event;n.preventHide?n.preventHide=!1:n.hide(t)},this.options.editor.on("blur",this.blurHandler),this.options.resizeObserver&&window.ResizeObserver&&(this.resizeObserver=new ResizeObserver((function(){n.isActive&&n.update(n.editorView)})),this.resizeObserver.observe(this.editorView.dom))}return v(e,[{key:"handleClick",value:function(){this.preventHide=!0}},{key:"update",value:function(e,t){var n=e.state;if(!(t&&t.doc.eq(n.doc)&&t.selection.eq(n.selection)))if(n.selection.empty){var i=e.domAtPos(n.selection.anchor);if("<br>"===i.node.innerHTML&&"P"===i.node.tagName&&i.node.parentNode===e.dom){var r=this.options.element.offsetParent;if(r){var o=r.getBoundingClientRect(),s=e.coordsAtPos(n.selection.anchor).top-o.top;this.isActive=!0,this.top=s,this.sendUpdate()}else this.hide()}else this.hide()}else this.hide()}},{key:"sendUpdate",value:function(){this.options.onUpdate({isActive:this.isActive,top:this.top})}},{key:"hide",value:function(e){e&&e.relatedTarget&&this.options.element.parentNode&&this.options.element.parentNode.contains(e.relatedTarget)||(this.isActive=!1,this.sendUpdate())}},{key:"destroy",value:function(){this.options.element.removeEventListener("mousedown",this.mousedownHandler),this.resizeObserver&&this.resizeObserver.unobserve(this.editorView.dom),this.options.editor.off("focus",this.focusHandler),this.options.editor.off("blur",this.blurHandler)}}]),e}();var X={props:{editor:{default:null,type:Object}},data:function(){return{menu:{isActive:!1,left:0,bottom:0}}},watch:{editor:{immediate:!0,handler:function(e){var n=this;e&&this.$nextTick((function(){var i;e.registerPlugin((i={editor:e,element:n.$el,onUpdate:function(e){e.isActive&&!1===n.menu.isActive?n.$emit("show",e):e.isActive||!0!==n.menu.isActive||n.$emit("hide",e),n.menu=e}},new t.Plugin({key:new t.PluginKey("floating_menu"),view:function(e){return new Q({editorView:e,options:i})}})))}))}}},render:function(){return this.editor?this.$scopedSlots.default({focused:this.editor.view.focused,focus:this.editor.focus,commands:this.editor.commands,isActive:this.editor.isActive,getMarkAttrs:this.editor.getMarkAttrs.bind(this.editor),getNodeAttrs:this.editor.getNodeAttrs.bind(this.editor),menu:this.menu}):null},beforeDestroy:function(){this.editor.unregisterPlugin("floating_menu")}};Object.defineProperty(e,"NodeSelection",{enumerable:!0,get:function(){return t.NodeSelection}}),Object.defineProperty(e,"Plugin",{enumerable:!0,get:function(){return t.Plugin}}),Object.defineProperty(e,"PluginKey",{enumerable:!0,get:function(){return t.PluginKey}}),Object.defineProperty(e,"TextSelection",{enumerable:!0,get:function(){return t.TextSelection}}),e.Doc=V,e.Editor=z,e.EditorContent=L,e.EditorFloatingMenu=X,e.EditorMenuBar=J,e.EditorMenuBubble=Z,e.Extension=H,e.Mark=D,e.Node=I,e.Paragraph=U,e.Text=$,Object.defineProperty(e,"__esModule",{value:!0})}));